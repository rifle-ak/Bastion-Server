roles:
  bastion:
    allowed_commands:
      - "uptime"
      - "df -h"
      - "df -h *"
      - "free -h"
      - "ps aux"
      - "ps aux *"
      - "top -bn1"
      - "dmesg *"
      - "ping -c * *"
      - "systemctl status *"
      - "systemctl list-units *"
      - "systemctl is-active *"
      - "journalctl -u * --no-pager -n *"
      - "journalctl -u * --no-pager -n * --since *"
      - "docker ps"
      - "docker ps *"
      - "docker logs *"
      - "cat /var/log/*"
      - "tail -n * /var/log/*"
    allowed_paths_read:
      - /var/log/
      - /etc/
      - /home/claude-agent/
    allowed_paths_write: []

  game-server:
    allowed_commands:
      - "uptime"
      - "df -h"
      - "df -h *"
      - "free -h"
      - "ps aux"
      - "ps aux *"
      - "top -bn1"
      - "top -b -n *"
      - "dmesg *"
      - "ping -c * *"
      - "iostat *"
      - "vmstat *"
      - "mpstat *"
      - "ss *"
      - "ip addr"
      - "ip addr *"
      - "ip route"
      - "ip route *"
      - "lsof *"
      - "systemctl status *"
      - "systemctl list-units *"
      - "systemctl is-active *"
      - "journalctl -u * --no-pager -n *"
      - "journalctl -u * --no-pager -n * --since *"
      - "journalctl -u * --no-pager --since *"
      # Docker: container listing, inspection, networking, volumes
      - "docker ps"
      - "docker ps *"
      - "docker logs *"
      - "docker inspect *"
      - "docker stats --no-stream"
      - "docker stats --no-stream *"
      - "docker top *"
      - "docker network ls"
      - "docker network ls *"
      - "docker network inspect *"
      - "docker volume ls"
      - "docker volume ls *"
      - "docker volume inspect *"
      - "docker port *"
      - "docker diff *"
      - "docker images"
      - "docker images *"
      # Read-only docker exec commands for container diagnostics
      - "docker exec * ps *"
      - "docker exec * ps"
      - "docker exec * top *"
      - "docker exec * df *"
      - "docker exec * df"
      - "docker exec * free *"
      - "docker exec * free"
      - "docker exec * uptime"
      - "docker exec * cat *"
      - "docker exec * head *"
      - "docker exec * tail *"
      - "docker exec * ls *"
      - "docker exec * ls"
      - "docker exec * wc *"
      - "docker exec * du *"
      - "docker exec * find *"
      - "docker exec * grep *"
      - "docker exec * env"
      - "docker exec * printenv"
      - "docker exec * printenv *"
      - "docker exec * id"
      - "docker exec * whoami"
      - "docker exec * hostname"
      - "docker exec * uname *"
      - "docker exec * uname"
      - "docker exec * stat *"
      - "docker exec * mount"
      - "docker exec * ss *"
      - "docker exec * ip *"
      - "docker exec * netstat *"
      - "docker exec * lsof *"
      # Pterodactyl Wings diagnostics
      - "wings diagnostics"
      - "wings diagnostics *"
      - "cat /etc/pterodactyl/*"
      - "cat /srv/pterodactyl/*"
      - "tail -n * /srv/pterodactyl/*"
      # Pterodactyl: send commands to game server console (REQUIRES APPROVAL)
      - "docker exec * rcon *"
      - "docker restart *"
      - "systemctl restart *"
    allowed_paths_read:
      - /var/log/
      - /etc/pterodactyl/
      - /srv/pterodactyl/
      - /var/lib/pterodactyl/
    allowed_paths_write: []

  monitoring:
    allowed_commands:
      - "uptime"
      - "df -h"
      - "df -h *"
      - "free -h"
      - "ps aux"
      - "ps aux *"
      - "top -bn1"
      - "top -b -n *"
      - "dmesg *"
      - "ping -c * *"
      - "iostat *"
      - "vmstat *"
      - "systemctl status *"
      - "systemctl list-units *"
      - "systemctl is-active *"
      - "docker ps"
      - "docker ps *"
      - "docker logs *"
      - "docker stats --no-stream"
      - "docker stats --no-stream *"
      - "docker top *"
      - "docker inspect *"
      - "docker compose -f /opt/monitoring/* ps"
      - "docker compose -f /opt/monitoring/* logs *"
      - "docker compose -f /opt/monitoring/* restart *"
      - "journalctl -u * --no-pager -n *"
      - "journalctl -u * --no-pager -n * --since *"
    allowed_paths_read:
      - /var/log/
      - /opt/monitoring/
    allowed_paths_write: []

  webhost:
    allowed_commands:
      - "uptime"
      - "df -h"
      - "df -h *"
      - "free -h"
      - "ps aux"
      - "ps aux *"
      - "top -bn1"
      - "dmesg *"
      - "ping -c * *"
      - "systemctl status *"
      - "systemctl list-units *"
      - "systemctl is-active *"
      - "systemctl restart *"                       # REQUIRES APPROVAL
      - "journalctl -u * --no-pager -n *"
      - "journalctl -u * --no-pager -n * --since *"
      # cPanel/WHM
      - "/usr/local/cpanel/bin/whmapi1 *"
      - "/scripts/restartsrv_*"                     # REQUIRES APPROVAL
      - "/usr/local/cpanel/bin/cplogin"
      - "whmapi1 *"
      # Apache
      - "httpd -S"
      - "httpd -t"
      - "apachectl status"
      - "apachectl configtest"
      # MySQL
      - "mysqladmin status"
      - "mysqladmin processlist"
      # DNS
      - "named-checkconf"
      - "named-checkzone *"
      # Mail
      - "exim -bpc"
      - "exim -bp"
      # General
      - "cat /var/log/*"
      - "tail -n * /var/log/*"
      - "tail -n * /usr/local/cpanel/logs/*"
    allowed_paths_read:
      - /var/log/
      - /etc/httpd/
      - /etc/my.cnf.d/
      - /etc/named/
      - /usr/local/cpanel/logs/
      - /var/cpanel/
      - /etc/cpanel/
    allowed_paths_write: []

  saltbox:
    allowed_commands:
      - "uptime"
      - "df -h"
      - "df -h *"
      - "free -h"
      - "ps aux"
      - "ps aux *"
      - "top -bn1"
      - "top -b -n *"
      - "dmesg *"
      - "ping -c * *"
      - "iostat *"
      - "vmstat *"
      - "systemctl status *"
      - "systemctl list-units *"
      - "systemctl is-active *"
      - "journalctl -u * --no-pager -n *"
      - "journalctl -u * --no-pager -n * --since *"
      # Docker â€” Saltbox runs everything in containers
      - "docker ps"
      - "docker ps *"
      - "docker logs *"
      - "docker inspect *"
      - "docker stats --no-stream"
      - "docker stats --no-stream *"
      - "docker top *"
      - "docker restart *"                          # REQUIRES APPROVAL
      - "docker compose -f /opt/saltbox/* ps"
      - "docker compose -f /opt/saltbox/* logs *"
      - "docker compose -f /opt/saltbox/* restart *" # REQUIRES APPROVAL
      # Saltbox CLI
      - "sb status"
      - "sb list"
      - "sb restart *"                              # REQUIRES APPROVAL
      # Plex
      - "cat /opt/plex/Library/Application Support/Plex Media Server/Logs/*"
      - "tail -n * /opt/plex/Library/Application Support/Plex Media Server/Logs/*"
      # General logs
      - "cat /var/log/*"
      - "tail -n * /var/log/*"
    allowed_paths_read:
      - /var/log/
      - /opt/saltbox/
      - /opt/plex/
      - /opt/sonarr/
      - /opt/radarr/
      - /opt/nzbget/
      - /opt/overseerr/
      - /etc/docker/
    allowed_paths_write: []

approval_required_patterns:
  - "restart"
  - "stop"
  - "kill"
  - "rm "
  - "remove"
  - "delete"
  - "drop"
  - "truncate"
  - "write"
  - "tee "
  - ">"
  - ">>"
